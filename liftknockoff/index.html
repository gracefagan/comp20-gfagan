<!DOCTYPE html>
<html>
<head>
	<title>The Private Car Service</title>
	<meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">

</head>

<script>

	//use HTTPXmlRequest to retrieve and display response data

	var request = new XMLHttpRequest();

	request.open("POST", "https://hans-moleman.herokuapp.com/rides", true);
	request.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

	//use navigator object to get current location
	var lat = -99999;
	var lng = -99999;

	function getLocation(){
		navigator.geolocation.getCurrentPosition(function(somePos){
			lat = somePos.coords.latitude;
			lng = somePos.coords.longitude;

			//send request with three parameters
			request.send("username=d4bazbp8&lat="+lat+"&lng="+lng);
			console.log("latitude: " + lat + " longitude: " + lng);
		});
	}

	request.onreadystatechange = function() {

		if (request.readyState == 4 && request.status == 200){

			vehicles = JSON.parse(request.responseText);
			console.log(request.responseText);

			data = document.getElementById("data");
			data.innerHTML = "";

			console.log("length of list: " + vehicles.length);

			for (count = 0 ; count < vehicles.length ; count++) {
				console.log("inside for loop");
				data.innerHTML += "<p>" + vehicles[count].username + "</p>";
			}
		}
	};

</script>

<body onload="getLocation()">

	<div id="data">Loading vehicle data</div>

</body>
</html>